library(tidyverse)
dir()
dados_brutos <- read.csv2("MJ_1_Mov_Lim_Saque.csv")
dados_brutos %>%
group_by(ID_ANO_LANC) %>%
summarise(sum(as.numeric(as.character(SALDORITEMINFORMAO))))
group_by(ID_ANO_LANC, CO_ORGAO) %>%
summarise(sum(as.numeric(as.character(SALDORITEMINFORMAO))))
dados_brutos %>%
filter(ID_ANO_LANC == 2018)
dados_brutos %>%
filter(ID_ANO_LANC == 2018) %>%
group_by(ID_ANO_LANC, CO_ORGAO) %>%
summarise(sum(as.numeric(as.character(SALDORITEMINFORMAO))))
View(dados_brutos)
dados_brutos %>%
filter(ID_DOCUMENTO == "SALDO INICIAL 2017") %>%
group_by(ID_ANO_LANC, CO_ORGAO) %>%
summarise(sum(as.numeric(as.character(SALDORITEMINFORMAO))))
dados_brutos %>%
filter(ID_ADNO_LANC == 2017) %>%
group_by(ID_ANO_LANC, CO_ORGAO) %>%
summarise(sum(as.numeric(as.character(SALDORITEMINFORMAO))))
dados_brutos %>%
filter(ID_ANO_LANC == 2017) %>%
group_by(ID_ANO_LANC, CO_ORGAO) %>%
summarise(sum(as.numeric(as.character(SALDORITEMINFORMAO))))
dados_brutos %>%
filter(ID_ANO_LANC == 2018) %>%
group_by(ID_ANO_LANC, CO_ORGAO) %>%
summarise(sum(as.numeric(as.character(SALDORITEMINFORMAO))))
dados_brutos %>%
filter(ID_DOCUMENTO == "SALDO INICIAL 2018") %>%
group_by(ID_ANO_LANC, CO_ORGAO) %>%
summarise(sum(as.numeric(as.character(SALDORITEMINFORMAO))))
146453962.09-52671524.35
487844311-35782294.23
library(tidyverse)
dados_brutos <- read.csv2("MJ_1_Mov_Lim_Saque.csv")
dados_brutos %>%
group_by(ID_ANO_LANC, CO_ORGAO) %>%
summarise(valor = sum(as.numeric(as.character(SALDORITEMINFORMAO)))) %>%
ungroup() %>%
spread(ID_ANO_LANC, valor)
nrow(dados_brutos)
decimal.mark = ",")
dados_brutos %>%
filter(ID_ANO_LANC == 2018) %>%
group_by(ID_ANO_LANC, CO_ORGAO) %>%
summarise(valor = scales::format(sum(as.numeric(as.character(SALDORITEMINFORMAO))),
big.mark = ".",
decimal.mark = ","))
dados_brutos %>%
filter(ID_ANO_LANC == 2018) %>%
group_by(ID_ANO_LANC, CO_ORGAO) %>%
summarise(valor = format(sum(as.numeric(as.character(SALDORITEMINFORMAO))),
big.mark = ".",
decimal.mark = ","))
nrow(dados_brutos)
dados_brutos %>%
filter(ID_ANO_LANC == 2018) %>%
group_by(ID_ANO_LANC, CO_ORGAO) %>%
summarise(valor = format(sum(as.numeric(as.character(SALDORITEMINFORMAO))),
big.mark = ".",
decimal.mark = ","))
nrow(dados_brutos)
dados_brutos %>%
filter(ID_ANO_LANC == 2018) %>%
group_by(ID_ANO_LANC, CO_ORGAO) %>%
summarise(valor = sum(as.numeric(as.character(SALDORITEMINFORMAO))))
nrow(dados_brutos)
dados_brutos %>%
filter(ID_ANO_LANC == 2018) %>%
group_by(CO_ORGAO) %>%
summarise(valor = sum(as.numeric(as.character(SALDORITEMINFORMAO))))
dados_brutos_Pag <- read.csv2("MJ_2_Mov_Pagamentos.csv")
dados_brutos_Pag %>%
filter(ID_ANO_LANC == 2018) %>%
group_by(CO_ORGAO) %>%
summarise(valor = sum(as.numeric(as.character(SALDORITEMINFORMAO))))
dados_brutos_Pag %>%
group_by(ID_ANO_LANC, CO_ORGAO) %>%
summarise(valor = sum(as.numeric(as.character(SALDORITEMINFORMAO)))) %>%
spread(ID_ANO_LANC)
dados_brutos_Pag %>%
group_by(ID_ANO_LANC, CO_ORGAO) %>%
summarise(valor = sum(as.numeric(as.character(SALDORITEMINFORMAO)))) %>%
spread(ID_ANO_LANC, valor)
dados_brutos_Obrig <- read.csv2("MJ_2_Mov_Obrigacoes.csv")
dados_brutos_Obrig <- read.csv2("MJ_3_Mov_Obrigacoes.csv")
dados_brutos_Obrig %>%
group_by(ID_ANO_LANC, CO_ORGAO) %>%
summarise(valor = sum(as.numeric(as.character(SALDORITEMINFORMAO)))) %>%
spread(ID_ANO_LANC, valor)
str(dados_brutos_Obrig)
dados_brutos_LimSq <- read.csv2("MJ_1_Mov_Lim_Saque.csv")
dados_brutos_LimSq %>%
group_by(ID_DOCUMENTO) %>%
count()
dados_brutos_LimSq %>%
group_by(ID_DOCUMENTO) %>%
summarise(qde_vinc = count(ID_VINCULACAO_PAGAMENTO))
dados_brutos_LimSq %>%
group_by(ID_DOCUMENTO) %>%
summarise(qde_vinc = n(ID_VINCULACAO_PAGAMENTO))
dados_brutos_LimSq %>%
group_by(ID_DOCUMENTO, ID_VINCULACAO_PAGAMENTO) %>%
count()
dados_brutos_LimSq %>%
group_by(ID_DOCUMENTO, ID_VINCULACAO_PAGAMENTO) %>%
count() %>%
filter(n>1)
qde_vincs <- dados_brutos_LimSq %>%
group_by(ID_DOCUMENTO, ID_VINCULACAO_PAGAMENTO) %>%
count()
qde_vincs <- dados_brutos_LimSq %>%
group_by(ID_DOCUMENTO, ID_VINCULACAO_PAGAMENTO) %>%
summarise(qde_vincs = n())
qde_vincs <- dados_brutos_LimSq %>%
group_by(ID_DOCUMENTO, ID_VINCULACAO_PAGAMENTO) %>%
summarise(qde_vincs = n()) %>%
ungroup()
qde_vincs%>%
filter(qde_vincs > 1)
qde_vincs%>%
mutate(tipo_doc = str_sub(ID_DOCUMENTO, 16, 17)) %>%
filter(qde_vincs > 1,
tipo_doc == "OB")
qde_vincs <- dados_brutos_LimSq %>%
group_by(ID_DOCUMENTO, ID_VINCULACAO_PAGAMENTO) %>%
summarise() %>%
ungroup() %>%
group_by(ID_DOCUMENTO) %>%
count()
qde_vincs <- dados_brutos_LimSq %>%
group_by(ID_DOCUMENTO, ID_VINCULACAO_PAGAMENTO) %>%
summarise() %>%
ungroup() %>%
group_by(ID_DOCUMENTO) %>%
count() %>%
ungroup()
qde_vincs%>%
mutate(tipo_doc = str_sub(ID_DOCUMENTO, 16, 17)) %>%
filter(n > 1,
tipo_doc == "OB")
